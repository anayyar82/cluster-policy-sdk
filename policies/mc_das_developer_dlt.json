
from pyspark.sql import SparkSession
from pyspark.sql.functions import from_json, col, schema_of_json
 
df = spark.read.table("`prod-adc-superiorlv-catalog-eu-west-1`.`lv-event`.`bronze_eventlog`")
 
schema = schema_of_json("""{"deviceType":40066,"info":{"percent":100,"scans":18},"uploader":{"firstName":"Jens","id":"00c318d3-f467-e911-815d-0610e6e38cbd","lastName":"Bï¿½hme"}}""")
df_1 = df.withColumn("parsed_json", from_json(col('D'), schema))
df_1.select('D','parsed_json').display()

{
    "autoscale.max_workers": {
      "defaultValue": 3,
      "maxValue": 10,
      "type": "range"
    },
    "autoscale.min_workers": {
      "hidden": true,
      "type": "fixed",
      "value": 1
    },
    "autotermination_minutes": {
      "hidden": true,
      "type": "fixed",
      "value": 0
    },
    "aws_attributes.availability": {
      "hidden": true,
      "type": "fixed",
      "value": "SPOT_WITH_FALLBACK"
    },
    "aws_attributes.first_on_demand": {
      "defaultValue": 100001,
      "minValue": 1,
      "type": "range"
    },
    "aws_attributes.instance_profile_arn": {
      "hidden": false,
      "type": "fixed",
      "value": "arn:aws:iam::188683556025:instance-profile/SC-188683556025-pp-odoyentbc6yei-InstanceProfile-OH0rrAA6Cdlz"
    },
    "aws_attributes.spot_bid_price_percent": {
      "hidden": true,
      "type": "fixed",
      "value": 100
    },
    "aws_attributes.zone_id": {
      "defaultValue": "auto",
      "hidden": true,
      "type": "unlimited"
    },
    "cluster_type": {
      "type": "fixed",
      "value": "dlt"
    },
    "custom_tags.cluster-type": {
      "type": "fixed",
      "value": "dlt"
    },
    "custom_tags.project": {
      "isOptional": false,
      "type": "unlimited"
    },
    "custom_tags.use-case": {
      "defaultValue": "SpendingPulse, SBCA, CustomerDataLandingZone",
      "type": "allowlist",
      "values": [
        "Data Engineering",
        "Machine Learning",
        "Data Science",
        "Operations",
        "Partner Engineering"
      ]
    },
    "custom_tags.COST_CENTER": {
      "type": "fixed",
      "value": "CC8801"
     },
    "data_security_mode": {
      "defaultValue": "NONE",
      "hidden": true,
      "type": "unlimited"
    },
    "dbus_per_hour": {
      "maxValue": 50,
      "type": "range"
    },
    "driver_instance_pool_id": {
      "hidden": true,
      "type": "forbidden"
    },
    "driver_node_type_id": {
      "hidden": true,
      "type": "unlimited"
    },
    "enable_elastic_disk": {
      "hidden": true,
      "type": "fixed",
      "value": true
    },
    "instance_pool_id": {
      "hidden": true,
      "type": "forbidden"
    },
    "node_type_id": {
      "hidden": true,
      "type": "unlimited"
    },
    "num_workers": {
      "hidden": true,
      "type": "forbidden"
    },
    "runtime_engine": {
      "hidden": true,
      "type": "fixed",
      "value": "STANDARD"
    },
    "spark_conf.spark.databricks.cluster.profile": {
      "hidden": true,
      "type": "forbidden"
    },
    "spark_version": {
      "defaultValue": "auto:latest-lts",
      "type": "unlimited"
    }
  }
